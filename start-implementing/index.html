
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://azure.github.io/enterprise-azure-policy-as-code/start-implementing/">
      
      
        <link rel="prev" href="../start-changes/">
      
      
        <link rel="next" href="../start-extracting-policy-resources/">
      
      
      <link rel="icon" href="../Images/10316-icon-service-Policy.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Start Implementation - Enterprise Policy As Code (EPAC)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#start-the-enterprise-policy-as-code-epac-implementation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Enterprise Policy As Code (EPAC)" class="md-header__button md-logo" aria-label="Enterprise Policy As Code (EPAC)" data-md-component="logo">
      
  <img src="../Images/10316-icon-service-Policy.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Enterprise Policy As Code (EPAC)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Start Implementation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Azure/enterprise-azure-policy-as-code" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../start-changes/" class="md-tabs__link">
          
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../settings-global-setting-file/" class="md-tabs__link">
          
  
    
  
  Settings and Desired State

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../integrating-with-alz/" class="md-tabs__link">
          
  
    
  
  Azure Landing Zones

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../policy-definitions/" class="md-tabs__link">
          
  
    
  
  Define Policy Resources

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ci-cd-overview/" class="md-tabs__link">
          
  
    
  
  CI/CD Integration

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../operational-scripts/" class="md-tabs__link">
          
  
    
  
  Operational Scripts

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Enterprise Policy As Code (EPAC)" class="md-nav__button md-logo" aria-label="Enterprise Policy As Code (EPAC)" data-md-component="logo">
      
  <img src="../Images/10316-icon-service-Policy.svg" alt="logo">

    </a>
    Enterprise Policy As Code (EPAC)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Azure/enterprise-azure-policy-as-code" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-changes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changes in v10.0.0
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Start Implementation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Start Implementation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#epac-concepts-and-environments" class="md-nav__link">
    <span class="md-ellipsis">
      EPAC Concepts and Environments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EPAC Concepts and Environments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#epac-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      EPAC Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-epac-environments" class="md-nav__link">
    <span class="md-ellipsis">
      Defining EPAC Environments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-tenant-support" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Tenant Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-management-group-structure-and-epac-environments" class="md-nav__link">
    <span class="md-ellipsis">
      Example Management Group Structure and EPAC Environments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-powershell-and-epac" class="md-nav__link">
    <span class="md-ellipsis">
      Install Powershell and EPAC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Install Powershell and EPAC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definitions-folder-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Definitions Folder Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-definitions-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Create the Definitions folder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-environment-with-unsupportedmissing-policy-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Environment with Unsupported/Missing Policy Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debug-epac-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Debug EPAC issues
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-extracting-policy-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extracting Policy Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-hydration-kit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydration Kit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-forking-github-repo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Forking GitHub Repo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Settings and Desired State
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Settings and Desired State
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings-global-setting-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings-desired-state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Desired State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings-dfc-assignments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DfC Assignments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure Landing Zones
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Azure Landing Zones
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrating-with-alz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ALZ Policy Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrating-with-alz-monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Monitor Baseline Alerts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrating-with-slz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sovereign Landing Zones
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Define Policy Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Define Policy Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-definitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Definitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-set-definitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Set Definitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-assignments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Assignment Files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-assignments-csv-parameters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSV Assignment Parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy-exemptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Exemptions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CI/CD Integration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            CI/CD Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CI/CD Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-app-registrations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    App Registrations Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-branching-flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Branching Flows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-ado-pipelines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure DevOps Pipelines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ci-cd-github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operational Scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Operational Scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scripts Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts-documenting-policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documenting Policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts-hydration-kit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hydration Kit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../operational-scripts-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#epac-concepts-and-environments" class="md-nav__link">
    <span class="md-ellipsis">
      EPAC Concepts and Environments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EPAC Concepts and Environments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#epac-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      EPAC Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-epac-environments" class="md-nav__link">
    <span class="md-ellipsis">
      Defining EPAC Environments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multi-tenant-support" class="md-nav__link">
    <span class="md-ellipsis">
      Multi-Tenant Support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-management-group-structure-and-epac-environments" class="md-nav__link">
    <span class="md-ellipsis">
      Example Management Group Structure and EPAC Environments
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-powershell-and-epac" class="md-nav__link">
    <span class="md-ellipsis">
      Install Powershell and EPAC
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Install Powershell and EPAC">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Installation Steps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#definitions-folder-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Definitions Folder Structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-definitions-folder" class="md-nav__link">
    <span class="md-ellipsis">
      Create the Definitions folder
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cloud-environment-with-unsupportedmissing-policy-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Environment with Unsupported/Missing Policy Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debug-epac-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Debug EPAC issues
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="start-the-enterprise-policy-as-code-epac-implementation">Start the Enterprise Policy as Code (EPAC) Implementation</h1>
<div class="admonition danger">
<p class="admonition-title">Caution</p>
<p>EPAC is a true desired state deployment technology. It takes possession of all Policy Resources at the <code>deploymentRootScope</code> and its children. It will <strong>delete any Policy resources not defined in the EPAC repo</strong>. This behavior can be modified as documented in the <a href="../settings-desired-state/">desired state strategy</a> page.</p>
</div>
<h2 id="getting-started">Getting Started</h2>
<p>The following steps are required to implement Enterprise Policy as Code (EPAC) in your environment:</p>
<ol>
<li>Understand <a href="#epac-concepts-and-environments">concepts and environments</a>.</li>
<li>Determine <a href="../settings-desired-state/">desired state strategy</a>.</li>
<li>How to handle <a href="../settings-dfc-assignments/">Defender for Cloud Policy Assignments</a>.</li>
<li>Design your <a href="../ci-cd-overview/">CI/CD process</a>.</li>
<li>Install <a href="#install-powershell-and-epac">Powershell and EPAC</a>.</li>
<li>Create your <a href="#create-the-definitions-folder"><code>Definitions</code> folder and subfolders</a>.</li>
<li>Populate <code>global-settings.jsonc</code> with your <a href="../settings-global-setting-file/">environment settings</a> and <a href="../settings-dfc-assignments/">desired state strategy</a>.</li>
<li>Populate your Definitions folder with Policy resources. (For a folder structure example, please see <a href="https://github.com/Azure/enterprise-azure-policy-as-code/tree/main/StarterKit/Definitions-Common">StarterKit/Definitions-Common</a>)<ul>
<li>[Option A:] <a href="../start-extracting-policy-resources/">Extract existing Policy resources</a> from your Azure environment.</li>
<li>[Option B:] <a href="../integrating-with-alz/">Integrate Azure Landing Zones (ALZ)</a>.</li>
<li>[Option C:] Utilize the <a href="../operational-scripts-hydration-kit/">hydration kit</a> and <code>StarterKit</code> content.</li>
<li>[Optional] Create custom <a href="../policy-definitions/">Policy definitions</a>.</li>
<li>[Optional] Create custom <a href="../policy-set-definitions/">Policy Set definitions</a>.</li>
<li>Create your <a href="../policy-assignments/">Policy Assignments</a>.</li>
<li>[Optional] Manage <a href="../policy-exemptions/">Policy Exemptions</a>.</li>
</ul>
</li>
<li>Implement your <a href="../ci-cd-overview/">CI/CD pipelines</a>.</li>
<li>Operate your environment with the provided <a href="../operational-scripts/">operational scripts</a>.</li>
</ol>
<h2 id="epac-concepts-and-environments">EPAC Concepts and Environments</h2>
<div class="admonition tip">
<p class="admonition-title">Important</p>
<p>Understanding the concepts and  environments is crucial. Do <strong>not</strong> proceed until you completely understand this section.</p>
</div>
<h3 id="epac-concepts">EPAC Concepts</h3>
<p>Like any other code development project (including Infrastructure as Code - IaC), developing Policy requires a development area to test and validate the Policy resources before deploying them to production. EPAC is no different.</p>
<ul>
<li>EPAC's nonprod environment is used to develop and test Policy resources. In most cases you will need one management group hierarchy to simulate EPAC production tenants and management groups for development and testing of Policy definitions and Policy Assignments.</li>
<li>EPAC's prod environment will govern all other IaC environments (e.g., sandbox, development, integration, test/qa, pre-prod, prod, ...) and tenants. This can be confusing. We will use <strong>EPAC environments</strong> and <strong>IaC environments</strong> to disambiguate the environments.</li>
</ul>
<h3 id="defining-epac-environments">Defining EPAC Environments</h3>
<p>EPAC defines environments identified by a string (unique per repository) called <code>pacSelector</code>. <code>pacEnvironments</code> in <code>global-settings.jsonc</code> environment map a <code>pacSelector</code> to the following settings:</p>
<ul>
<li><code>cloud</code> - to select commercial or sovereign cloud environments.</li>
<li><code>tenantId</code> - enables multi-tenant scenarios.</li>
<li><code>rootDefinitionScope</code> - scope for custom Policy and Policy Set definition deployment.</li>
<li>[Optional] Define the following items:</li>
<li><code>globalNotScopes</code> - used to exclude scopes from Policy Assignments.</li>
<li><code>managedIdentityLocation</code> - used for the location for created Managed Identities.</li>
<li><code>desiredState</code> - desired state strategy and details for Policy resources.</li>
<li><code>managedTenant</code> - used for environments that are in a lighthouse managed tenant.</li>
</ul>
<p>These associations are stored in <a href="../settings-global-setting-file/">global-settings.jsonc</a> in an element called <code>pacEnvironments</code>.</p>
<h3 id="multi-tenant-support">Multi-Tenant Support</h3>
<p>EPAC supports single and multi-tenant deployments from a single source. In most cases you should have a fully or partially isolated area for Policy development and testing, such as a Management Group. An entire tenant can be used; however, it is not necessary since EPAC has sophisticated partitioning capabilities.  EPAC also supports deployments to managed (Lighthouse) tenants and is able to deploy cross tenant role assignments to projected subscriptions in order to facilitate writing data back to the managing tenant (e.g. diagnostic settings).</p>
<h3 id="example-management-group-structure-and-epac-environments">Example Management Group Structure and EPAC Environments</h3>
<p>Assuming that you have a single tenant with a management group hierarchy as follows (with additional levels of management groups not shown for brevity):</p>
<ul>
<li>Root tenant (always present)</li>
<li>mg-Enterprise (pseudo root)<ul>
<li>mg-Identity</li>
<li>mg-NonProd</li>
<li>mg-Dev</li>
<li>mg-Sandbox</li>
<li>...</li>
<li>mg-Prod</li>
<li>mg-LandingZones</li>
<li>mg-PCI</li>
<li>mg-EpacDev (EPAC development)</li>
</ul>
</li>
</ul>
<p>You should create a development testing structure for EPAC in <code>mg-EpacDev</code>. We have found little need for a separate management group for EPAC testing, but you can create one mirroring the structure of <code>mg-EpacDev</code>.</p>
<ul>
<li>Root tenant (always present)</li>
<li>mg-Enterprise (pseudo root) :arrow_right: <strong>EPAC environment <code>"tenant"</code></strong><ul>
<li>mg-Identity</li>
<li>mg-NonProd</li>
<li>mg-Sandbox</li>
<li>mg-Prod</li>
<li>mg-PCI</li>
<li>mg-EpacDev (EPAC development) :arrow_right: <strong>EPAC environment <code>"epac-dev"</code></strong></li>
<li>mg-EpacDev-Identity</li>
<li>mg-EpacDev-NonProd<ul>
<li>mg-EpacDev-Dev</li>
<li>mg-EpacDev-Sandbox</li>
</ul>
</li>
<li>mg-EpacDev-Prod<ul>
<li>mg-EpacDev-LandingZones</li>
<li>mg-EpacDev-PCI</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The simplest <code>global-settings.jsonc</code> for the above structure is:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://raw.githubusercontent.com/Azure/enterprise-azure-policy-as-code/main/Schemas/global-settings-schema.json&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pacOwnerId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{guid}}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;pacEnvironments&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;pacSelector&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;epac-dev&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;cloud&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AzureCloud&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;tenantId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{tenant-id}}&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;deploymentRootScope&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/providers/Microsoft.Management/managementGroups/mg-Epac-Dev&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;pacSelector&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tenant&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;cloud&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;AzureCloud&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;tenantId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{tenant-id}}&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;deploymentRootScope&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/providers/Microsoft.Management/managementGroups/mg-Enterprise&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>For assignment files, this is a top level property on the assignment's root node:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;nodeName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/root&quot;</span><span class="p">,</span>
<span class="nt">&quot;epacCloudEnvironments&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;AzureChinaCloud&quot;</span>
<span class="p">],</span>
</code></pre></div>
<h2 id="install-powershell-and-epac">Install Powershell and EPAC</h2>
<p>EPAC can be installed in two ways:</p>
<ul>
<li>Install the <code>EnterprisePolicyAsCode</code> module from the <a href="https://www.powershellgallery.com/packages/EnterprisePolicyAsCode">PowerShell marketplace</a>. This is the recommended approach documented here.</li>
<li>Copy the source code from an <a href="https://github.com/Azure/enterprise-azure-policy-as-code">EPAC GitHub repository</a> fork. The process is described in <a href="../start-forking-github-repo/">Forking the GitHub Repo - an Alternate Installation Method</a> page.</li>
</ul>
<h3 id="installation-steps">Installation Steps</h3>
<ol>
<li><a href="https://github.com/PowerShell/PowerShell/releases">Install PowerShell 7.4 or later</a>.</li>
<li>Install the Az PowerShell modules and Enterprise Policy as Code module.</li>
</ol>
<div class="highlight"><pre><span></span><code>    <span class="nb">Install-Module</span> <span class="n">Az</span> <span class="n">-Scope</span> <span class="n">CurrentUser</span>
    <span class="nb">Install-Module</span> <span class="n">EnterprisePolicyAsCode</span> <span class="n">-Scope</span> <span class="n">CurrentUser</span>
</code></pre></div>
<p>Many scripts use parameters for input and output folders. They default to the current directory. We recommend that you do one of the following approaches instead of accepting the default to prevent your files being created in the wrong location:
    - [Preferred] Set the environment variables <code>PAC_DEFINITIONS_FOLDER</code>, <code>PAC_OUTPUT_FOLDER</code>, and <code>PAC_INPUT_FOLDER</code>.
    - [Alternative] Use the script parameters <code>-DefinitionsRootFolder</code>, <code>-OutputFolder</code>, and <code>-InputFolder</code>.</p>
<h3 id="definitions-folder-structure"><code>Definitions</code> Folder Structure</h3>
<ul>
<li>Define the Azure environment(s) in file <code>global-settings.jsonc</code></li>
<li>Create custom Policies (optional) in folder <code>policyDefinitions</code></li>
<li>Create custom Policy Sets (optional) in folder <code>policySetDefinitions</code></li>
<li>Define the Policy Assignments in folder <code>policyAssignments</code></li>
<li>Define the Policy Exemptions (optional) in folder <code>policyExemptions</code></li>
<li>Define Documentation in folder <code>policyDocumentations</code></li>
</ul>
<h3 id="create-the-definitions-folder">Create the Definitions folder</h3>
<p>Create a new EPAC <code>Definitions</code> folder with a number of subfolder and a <code>global-settings.jsonc</code> file.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For a folder structure example, please see <a href="https://github.com/Azure/enterprise-azure-policy-as-code/tree/main/StarterKit/Definitions-Common">StarterKit/Definitions-Common</a>.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nb">New-HydrationDefinitionFolder</span> <span class="n">-DefinitionsRootFolder</span> <span class="n">Definitions</span>
</code></pre></div>
<h2 id="cloud-environment-with-unsupportedmissing-policy-definitions">Cloud Environment with Unsupported/Missing Policy Definitions</h2>
<p>In some multi-tenant implementations, not all policies, policy sets, and/or assignments will function in all tenants, usually due to either built-in policies that don't exist in some tenant types or unavailable resource providers.  In order to facilitate multi-tenant deployments in these scenarios, utilize the <code>epacCloudEnvironments</code> property to specify which cloud type a specific file should be considered in.  For example in order to have a policy definition deployed only to epacEnvironments that are China cloud tenants, add a metadata property like this to that definition (or definitionSet) file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&quot;metadata&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;epacCloudEnvironments&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;AzureChinaCloud&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">},</span>
</code></pre></div>
<h2 id="debug-epac-issues">Debug EPAC issues</h2>
<p>Should you encounter issues with the expected behavior of EPAC, try the following:</p>
<ul>
<li>Run the scripts interactively.</li>
<li><a href="https://learn.microsoft.com/en-us/powershell/scripting/dev-cross-plat/vscode/using-vscode?view=powershell-7.3">Debug the scripts in VS Code</a>.</li>
<li>Ask for help by raising a <a href="https://github.com/Azure/enterprise-azure-policy-as-code/issues">GitHub Issue</a></li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.indexes", {"navigation.sections": {"level": 1}}, "navigation.tabs", "navigation.tabs.sticky", "content.code.annotate", "content.tabs.link", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>